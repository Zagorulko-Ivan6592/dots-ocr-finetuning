# dots.ocr: Fine-tuning и Inference

Репозиторий для дообучения и использования модели [dots.ocr](https://github.com/rednote-hilab/dots.ocr) для OCR и парсинга документов на русском языке.

## Что сделано

### 1. Подготовка датасета
- Найден и подготовлен датасет PDF документов на русском языке
- Датасет содержит разнообразные документы: таблицы, текст, формулы, изображения

### 2. Дообучение модели dots.ocr
- Дообучение базовой модели `rednote-hilab/dots.ocr` с использованием LoRA (Low-Rank Adaptation)
- Обучение на русскоязычных PDF документах для улучшения качества OCR
- Объединение LoRA адаптеров с базовой моделью для получения единой дообученной модели
- Результат: дообученная модель готова к использованию

### 3. Оценка качества
- Проведена оценка базовой и дообученной модели на различных бенчмарках:
  - **OCRBench** - стандартный бенчмарк для OCR
  - **OCRBench v2** - обновленная версия OCRBench
  - **MWS-Vision-Bench** - русскоязычный бенчмарк для мультимодальных LLM
- Результаты показывают улучшение качества распознавания после дообучения

### 4. Публикация модели
- Дообученная модель опубликована на Hugging Face Hub
- **Модель доступна по адресу:** [normoldaki31/dots-ocr-finetuned](https://huggingface.co/normoldaki31/dots-ocr-finetuned)
- Модель можно использовать напрямую из Hugging Face Hub или скачать локально

### 5. Ноутбуки для инференса
- **`colab_inference_default.ipynb`** - инференс базовой модели dots.ocr
  - Обработка PDF документов
  - Извлечение текста, таблиц, формул
  - Восстановление Markdown и PDF из результатов
  
- **`colab_inference_merged.ipynb`** - инференс дообученной модели
  - Все возможности базовой модели
  - Улучшенная точность на специфических документах после дообучения

## Результаты бенчмарков

После дообучения на русскоязычных PDF документах модель показала улучшение на различных бенчмарках:

### Сравнение базовой и дообученной модели

![Benchmark Comparison](./benchmark_comparison.png)

*График сравнения метрик базовой и дообученной модели. График будет обновлен после завершения всех бенчмарков.*


